<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JUMPANZ V1.0 - Prima Motion Technology</title>
    <!-- Import Fonts: Open Sans for UI and Josefin Sans for Brand -->
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;700&family=Josefin+Sans:wght@700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
    <script src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root {
            --primary: #4d2994;
            --primary-dark: #1a0f30; 
            --accent: #D0c3f1;
            --bg: #ffffff; 
            --text-main: #1a0f30;
            --signal-red: #ef4444;
            --signal-yellow: #facc15;
            --signal-green: #22c55e;
            --signal-off: #e5e7eb;
        }
        body { 
            font-family: 'Open Sans', sans-serif; 
            background-color: var(--bg); 
            color: var(--text-main); 
            -webkit-font-smoothing: antialiased;
        }
        
        .brand-text { 
            font-family: 'Josefin Sans', sans-serif; 
            font-weight: 700; 
            text-transform: uppercase;
        }

        /* Traffic Light Signal Bulbs */
        .light-bulb {
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background-color: var(--signal-off);
            transition: all 0.3s ease;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
        }
        .light-active-red { background-color: var(--signal-red); box-shadow: 0 0 12px var(--signal-red); }
        .light-active-yellow { background-color: var(--signal-yellow); box-shadow: 0 0 12px var(--signal-yellow); }
        .light-active-green { background-color: var(--signal-green); box-shadow: 0 0 12px var(--signal-green); }

        /* Minimal Table Styling */
        .report-table th { 
            background-color: transparent; 
            padding: 16px 12px; 
            font-size: 11px; 
            text-transform: uppercase; 
            letter-spacing: 0.1em; 
            font-weight: 700; 
            color: var(--primary);
            border-bottom: 2px solid var(--primary);
        }
        .report-table td { 
            border-bottom: 1px solid #f0f0f0; 
            padding: 16px 12px; 
            font-size: 14px; 
            font-weight: 600;
            color: var(--text-main);
        }
        .phase-header { 
            background-color: #f8f6fb !important; 
            color: var(--primary-dark) !important; 
            font-family: 'Open Sans', sans-serif;
            font-size: 12px !important; 
            letter-spacing: 0.12em; 
            border-bottom: 1px solid var(--accent) !important;
        }
        
        input[type="number"]::-webkit-inner-spin-button { display: none; }
        
        .control-card {
            background: #ffffff;
            border: 1px solid #e5e7eb;
            box-shadow: 0 4px 30px rgba(0,0,0,0.05);
        }
        
        .input-minimal {
            background-color: #f3f4f6;
            border: 1.5px solid #9ca3af; 
            color: var(--primary-dark);
            font-weight: 700;
        }
        .input-minimal:focus {
            border-color: var(--primary);
            background-color: #ffffff;
            outline: none;
        }

        .sidebar-label {
            color: var(--primary-dark);
            font-weight: 700;
            text-transform: uppercase;
            font-size: 11px;
            letter-spacing: 0.05em;
        }

        .logo-box {
            height: 96px;
            width: auto;
            max-width: 280px;
            object-fit: contain;
        }
    </style>
</head>
<body class="p-4 md:p-8">

    <div class="max-w-7xl mx-auto">
        <!-- Header Section -->
        <header class="flex flex-col md:flex-row justify-between items-center mb-12 border-b border-gray-100 pb-8">
            <div class="text-center md:text-left">
                <h1 class="text-6xl brand-text tracking-tighter text-primary">JUMPANZ <span class="text-2xl font-normal opacity-30 italic">V1.7.1 PRO</span></h1>
                <p class="brand-text text-[14px] tracking-[0.2em] mt-2 text-primary-dark">PRIMA MOTION TECHNOLOGY</p>
                <p class="text-[10px] italic font-semibold text-primary-dark opacity-50 mt-1 tracking-wider">Technology that unlocks scientific insight</p>
            </div>
            
            <div class="flex flex-col items-end gap-3 mt-8 md:mt-0">
                <!-- Updated Company Logo URL -->
                <img src="https://assets.zyrosite.com/AwvkPRPaQNI9Dwxw/prima-logo-vector-color-YKbrek2a2qT61kV4.svg" alt="PRIMA MOTION TECHNOLOGY" class="logo-box" onerror="this.style.display='none'; document.getElementById('logo-fallback').style.display='block';">
                <div id="logo-fallback" class="hidden text-right">
                    <p class="brand-text text-primary text-xl">PRIMA MOTION</p>
                    <p class="text-[8px] font-bold opacity-40">TECHNOLOGY</p>
                </div>
                <p id="fileNameDisplay" class="text-[12px] italic text-primary-dark opacity-60 font-bold tracking-tight">System Ready</p>
            </div>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-10">
            <!-- Sidebar Controls -->
            <aside class="lg:col-span-3 space-y-6">
                <div class="control-card p-8 rounded-[2.5rem] space-y-8">
                    <!-- 1. Upload Button -->
                    <div>
                        <label class="block text-center bg-primary text-white font-bold py-4 px-4 rounded-2xl cursor-pointer hover:bg-primary-dark transition-all text-xs tracking-widest uppercase shadow-md">
                            ðŸ“‚ Import Data (CSV)
                            <input type="file" id="fileInput" accept=".csv" class="hidden">
                        </label>
                    </div>

                    <!-- 2. Status Traffic Light -->
                    <div class="bg-gray-50 p-5 rounded-2xl border border-gray-100">
                        <div class="flex items-center justify-between mb-3">
                            <span id="statusText" class="text-[10px] font-extrabold uppercase text-primary-dark tracking-widest">Wait for Data</span>
                            <div class="flex gap-1.5">
                                <div id="lightRed" class="light-bulb light-active-red"></div>
                                <div id="lightYellow" class="light-bulb"></div>
                                <div id="lightGreen" class="light-bulb"></div>
                            </div>
                        </div>
                        <div class="h-1 w-full bg-gray-200 rounded-full overflow-hidden">
                            <div id="statusProgress" class="h-full bg-primary transition-all duration-300" style="width: 0%"></div>
                        </div>
                    </div>

                    <!-- 3. Configuration -->
                    <div class="space-y-5 pt-2">
                        <div>
                            <label class="sidebar-label block mb-2">Smoothing</label>
                            <select id="filterSize" class="w-full p-3 input-minimal rounded-xl text-xs outline-none shadow-sm">
                                <option value="1">Raw Data</option>
                                <option value="7">Low Filter</option>
                                <option value="15" selected>Standard (15)</option>
                                <option value="31">High Filter (31)</option>
                            </select>
                        </div>
                        <div>
                            <label class="sidebar-label block mb-2">Asymmetry Alert %</label>
                            <input type="number" id="threshold" value="15" class="w-full p-3 input-minimal rounded-xl text-xs text-center outline-none shadow-sm">
                        </div>
                    </div>

                    <!-- 4. Phase Adjust -->
                    <div class="pt-8 border-t border-gray-100">
                        <p class="text-[11px] font-bold uppercase mb-5 text-primary-dark tracking-[0.2em] border-l-4 border-primary pl-3">Phase Adjustment</p>
                        <div class="space-y-4">
                            <div class="flex items-center justify-between">
                                <span class="sidebar-label">Start (s)</span>
                                <input type="number" id="manualStart" step="0.001" class="w-24 bg-gray-50 border border-gray-300 p-2.5 rounded-xl text-right text-xs font-bold text-primary-dark outline-none focus:border-primary">
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="sidebar-label">V=0 (s)</span>
                                <input type="number" id="manualSplit" step="0.001" class="w-24 bg-gray-50 border border-gray-300 p-2.5 rounded-xl text-right text-xs font-bold text-primary-dark outline-none focus:border-primary">
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="sidebar-label">Take-off (s)</span>
                                <input type="number" id="manualEnd" step="0.001" class="w-24 bg-gray-50 border border-gray-300 p-2.5 rounded-xl text-right text-xs font-bold text-primary-dark outline-none focus:border-primary">
                            </div>
                        </div>
                        <button id="reprocessBtn" class="w-full mt-8 bg-primary text-white text-[11px] font-bold py-4 rounded-xl hover:bg-primary-dark transition-all uppercase tracking-widest shadow-md">
                            ðŸ”„ Re-calculate
                        </button>
                    </div>
                </div>
                
                <button id="exportBtn" class="w-full bg-emerald-600 text-white font-bold py-5 rounded-[2rem] hover:bg-emerald-700 transition-all hidden text-xs uppercase tracking-[0.2em] shadow-lg">
                    ðŸ“¥ Download Report
                </button>
            </aside>

            <!-- Main Dashboard -->
            <main class="lg:col-span-9 space-y-10">
                
                <!-- Reporting Table Area -->
                <div class="bg-white rounded-[3rem] p-10 border border-gray-100 shadow-sm">
                    <div class="flex justify-between items-center mb-8">
                        <h3 class="text-sm font-bold uppercase tracking-[0.25em] text-primary-dark">
                            Metric Analysis Report
                        </h3>
                        <div class="h-1 w-20 bg-accent rounded-full"></div>
                    </div>
                    
                    <div id="tableContainer" class="overflow-x-auto">
                        <div class="text-center py-20">
                            <p class="text-sm text-primary-dark opacity-40 italic font-medium tracking-wide">Waiting for biomechanical data input...</p>
                        </div>
                    </div>
                </div>

                <!-- Charts Container -->
                <div class="grid grid-cols-1 gap-10 pb-20">
                    <div class="bg-white rounded-[3rem] p-8 border border-gray-100 shadow-sm">
                        <div id="forceChart" class="w-full h-[400px]"></div>
                    </div>
                    <div class="bg-white rounded-[3rem] p-8 border border-gray-100 shadow-sm">
                        <div id="deficitChart" class="w-full h-[250px]"></div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <script>
        const regex = /(-?\d+\.\d+)/;
        let rawData = [];
        let reportData = {};

        function setSignal(state, progress, text) {
            const red = document.getElementById('lightRed');
            const yellow = document.getElementById('lightYellow');
            const green = document.getElementById('lightGreen');
            const progBar = document.getElementById('statusProgress');
            const statusLabel = document.getElementById('statusText');

            red.classList.remove('light-active-red');
            yellow.classList.remove('light-active-yellow');
            green.classList.remove('light-active-green');

            if (state === 'waiting') {
                red.classList.add('light-active-red');
            } else if (state === 'processing') {
                yellow.classList.add('light-active-yellow');
            } else if (state === 'done') {
                green.classList.add('light-active-green');
            }

            progBar.style.width = progress + '%';
            statusLabel.innerText = text;
        }

        function cleanValue(val) {
            if (val === null || val === undefined) return null;
            let s = val.toString().trim();
            let match = s.match(regex);
            return match ? parseFloat(match[1]) : null;
        }

        function movingAverage(d, s) {
            if (s <= 1) return d;
            let res = [], h = Math.floor(s/2);
            for(let i=0; i<d.length; i++){
                let start = Math.max(0, i-h), end = Math.min(d.length, i+h+1);
                let sum = 0; for(let j=start; j<end; j++) sum += d[j];
                res.push(sum/(end-start));
            }
            return res;
        }

        document.getElementById('fileInput').addEventListener('change', e => {
            const file = e.target.files[0];
            if (!file) return;
            document.getElementById('fileNameDisplay').innerText = file.name;
            setSignal('processing', 30, "Reading...");
            Papa.parse(file, {
                header: true, skipEmptyLines: true,
                complete: function(results) {
                    rawData = results.data;
                    setSignal('processing', 50, "Parsing...");
                    processBiomechanics(true);
                }
            });
        });

        document.getElementById('reprocessBtn').addEventListener('click', () => processBiomechanics(false));

        function processBiomechanics(isAuto) {
            if (rawData.length === 0) return;
            setSignal('processing', 80, "Calculating...");

            const filterSize = parseInt(document.getElementById('filterSize').value);
            const threshold = parseFloat(document.getElementById('threshold').value);
            
            let t = [], f = [], l = [], r = [];
            
            rawData.forEach(row => {
                let total = cleanValue(row['force ']);
                let left = cleanValue(row['left force']);
                let right = cleanValue(row['right force']);
                let time = parseFloat(row['time']);

                if (!isNaN(time)) {
                    if (total === null && left !== null && right !== null) total = left + right;
                    if (left === null && total !== null && right !== null) left = total * 0.5;
                    if (right === null && total !== null && left !== null) right = total - left;
                    t.push(time); f.push(total || 0); l.push(left || 0); r.push(right || 0);
                }
            });

            const sf = movingAverage(f, filterSize);
            const sl = movingAverage(l, filterSize);
            const sr = movingAverage(r, filterSize);
            const g = 9.80665, dt = t[1] - t[0];

            const quietSamples = Math.floor(0.5 / dt);
            const bw = sf.slice(0, quietSamples).reduce((a, b) => a + b, 0) / quietSamples;
            const mass = bw / g;

            let sIdx, zIdx, tIdx, lIdx;

            if (isAuto) {
                sIdx = sf.findIndex(v => Math.abs(v - bw) > (bw * 0.05));
                if (sIdx < 0) sIdx = 0;
                tIdx = sf.findIndex((v, i) => i > sIdx && v < 25);
                if (tIdx < 0) tIdx = sf.length - 1;

                let v_temp = 0, minV_temp = 0;
                zIdx = sIdx;
                for (let i = sIdx; i <= tIdx; i++) {
                    v_temp += ((sf[i] - bw) / mass) * dt;
                    if (v_temp < minV_temp) {
                        minV_temp = v_temp;
                        zIdx = i;
                    }
                }
                
                document.getElementById('manualStart').value = t[sIdx].toFixed(3);
                document.getElementById('manualSplit').value = t[zIdx].toFixed(3);
                document.getElementById('manualEnd').value = t[tIdx].toFixed(3);
            } else {
                sIdx = Math.max(0, t.findIndex(val => val >= parseFloat(document.getElementById('manualStart').value)));
                zIdx = Math.max(0, t.findIndex(val => val >= parseFloat(document.getElementById('manualSplit').value)));
                tIdx = Math.max(0, t.findIndex(val => val >= parseFloat(document.getElementById('manualEnd').value)));
            }

            const bufferSamples = Math.floor(0.05 / dt);
            lIdx = sf.findIndex((v, i) => i > tIdx + bufferSamples && v > 30);
            if (lIdx < 0) lIdx = sf.length - 1;

            // Zeroing Flight Phase
            for (let i = tIdx; i < lIdx; i++) {
                sf[i] = 0; sl[i] = 0; sr[i] = 0;
            }

            let vArr = [], v = 0, currentDisplacement = 0, maxDisplacement = 0;
            let eccPeakVel = 0, eccPeakPower = 0, eccPowerSum = 0;
            let eccForceArr = sf.slice(sIdx, zIdx + 1);
            let eccPeakForce = Math.max(...eccForceArr);
            let eccMeanForce = eccForceArr.reduce((a,b)=>a+b,0) / eccForceArr.length;
            let eccDuration = t[zIdx] - t[sIdx];

            let conPeakVel = 0, conPeakPower = 0, conPowerSum = 0;
            let conForceArr = sf.slice(zIdx, tIdx + 1);
            let conPeakForce = conForceArr.length > 0 ? Math.max(...conForceArr) : 0;
            let conMeanForce = conForceArr.length > 0 ? (conForceArr.reduce((a,b)=>a+b,0) / conForceArr.length) : 0;
            let conDuration = t[tIdx] - t[zIdx];

            for (let i = sIdx; i <= tIdx; i++) {
                v += ((sf[i] - bw) / mass) * dt;
                vArr.push(v);
                currentDisplacement += v * dt;
                let pwr = sf[i] * v;

                if (i <= zIdx) {
                    if (v < eccPeakVel) eccPeakVel = v;
                    if (pwr < eccPeakPower) eccPeakPower = pwr; 
                    eccPowerSum += pwr;
                    if (currentDisplacement < maxDisplacement) maxDisplacement = currentDisplacement;
                } else {
                    if (v > conPeakVel) conPeakVel = v;
                    if (pwr > conPeakPower) conPeakPower = pwr;
                    conPowerSum += pwr;
                }
            }

            const jh = (Math.pow(conPeakVel, 2) / (2 * g)) * 100;
            const ct = t[tIdx] - t[sIdx];
            const rsi = (jh / 100) / ct;
            const cmDepth = Math.abs(maxDisplacement) * 100;

            let flightTime = 0, peakLandingForce = 0;
            if (lIdx > tIdx && lIdx < sf.length) {
                flightTime = t[lIdx] - t[tIdx];
                const landingEndIdx = Math.min(sf.length, lIdx + Math.floor(0.5 / dt));
                let landingForceArr = sf.slice(lIdx, landingEndIdx);
                peakLandingForce = landingForceArr.length > 0 ? Math.max(...landingForceArr) : 0;
            }

            reportData = {
                "General Overview": {
                    "Jump Height (Imp-Mom)": { val: jh.toFixed(1), unit: "cm" },
                    "Contraction Time": { val: ct.toFixed(2), unit: "s" },
                    "RSI-Modified": { val: rsi.toFixed(2), unit: "m/s" },
                    "Countermovement Depth": { val: cmDepth.toFixed(1), unit: "cm" }
                },
                "Eccentric Phase": {
                    "Duration": { val: eccDuration.toFixed(2), unit: "s" },
                    "Peak Force": { val: eccPeakForce.toFixed(0), unit: "N" },
                    "Mean Force": { val: eccMeanForce.toFixed(0), unit: "N" },
                    "Peak Power (Abs)": { val: Math.abs(eccPeakPower).toFixed(0), unit: "W" },
                    "Peak Velocity (Abs)": { val: Math.abs(eccPeakVel).toFixed(2), unit: "m/s" }
                },
                "Concentric Phase": {
                    "Duration": { val: conDuration.toFixed(2), unit: "s" },
                    "Peak Force": { val: conPeakForce.toFixed(0), unit: "N" },
                    "Mean Force": { val: conMeanForce.toFixed(0), unit: "N" },
                    "Peak Power": { val: conPeakPower.toFixed(0), unit: "W" },
                    "Peak Velocity": { val: conPeakVel.toFixed(2), unit: "m/s" }
                },
                "Landing Phase": {
                    "Flight Time": { val: flightTime > 0 ? flightTime.toFixed(2) : "N/A", unit: "s" },
                    "Peak Landing Force": { val: peakLandingForce > 0 ? peakLandingForce.toFixed(0) : "N/A", unit: "N" }
                }
            };

            updateTableUI();

            const deficits = sf.map((v, i) => {
                if (v < 50) return 0;
                const diff = sl[i] - sr[i];
                return (diff / Math.max(sl[i], sr[i])) * 100;
            });

            const layoutBase = {
                font: { family: 'Open Sans', color: '#1a0f30' },
                paper_bgcolor: 'rgba(0,0,0,0)', plot_bgcolor: 'rgba(0,0,0,0)',
                margin: { t: 60, b: 60, l: 60, r: 20 },
                xaxis: { gridcolor: '#f3f4f6', titlefont: { size: 11, weight: 700 }, tickfont: {size: 10} },
                yaxis: { gridcolor: '#f3f4f6', titlefont: { size: 11, weight: 700 }, tickfont: {size: 10} }
            };

            const eccLabelX = t[sIdx] + (t[zIdx] - t[sIdx]) / 2;
            const conLabelX = t[zIdx] + (t[tIdx] - t[zIdx]) / 2;
            const maxForceVal = Math.max(...sf);

            Plotly.newPlot('forceChart', [
                { x: t, y: sl, name: 'Left Limb', line: { color: '#818cf8', width: 2 } },
                { x: t, y: sr, name: 'Right Limb', line: { color: '#f87171', width: 2 } },
                { x: t, y: sf, name: 'Total Force', line: { color: '#4d2994', width: 3.5 } }
            ], {
                ...layoutBase,
                title: { text: 'FORCE-TIME ANALYSIS', font: { size: 15, weight: 700 }, x: 0 },
                shapes: [
                    { type: 'rect', x0: t[sIdx], x1: t[zIdx], y0: 0, y1: maxForceVal * 1.15, fillcolor: 'rgba(77, 41, 148, 0.05)', line: {width: 0} },
                    { type: 'rect', x0: t[zIdx], x1: t[tIdx], y0: 0, y1: maxForceVal * 1.15, fillcolor: 'rgba(34, 197, 94, 0.05)', line: {width: 0} }
                ],
                annotations: [
                    { x: eccLabelX, y: maxForceVal * 1.05, text: 'ECCENTRIC', showarrow: false, font: {size: 10, weight: 700, color: '#4d2994'}, xanchor: 'center' },
                    { x: conLabelX, y: maxForceVal * 1.05, text: 'CONCENTRIC', showarrow: false, font: {size: 10, weight: 700, color: '#22c55e'}, xanchor: 'center' },
                    { x: t[sIdx], y: bw, text: 'START', showarrow: true, font: {size: 10, weight: 700}, ax: 0, ay: -30 },
                    { x: t[tIdx], y: 100, text: 'TAKE-OFF', showarrow: true, font: {size: 10, color: 'red', weight: 700}, ax: 0, ay: -40 }
                ]
            }, { responsive: true, displayModeBar: false });

            Plotly.newPlot('deficitChart', [
                { 
                    x: t, y: deficits, name: 'Asymmetry', type: 'scatter', 
                    fill: 'tozeroy', fillcolor: 'rgba(77, 41, 148, 0.15)',
                    line: { color: '#4d2994', width: 2.5 } 
                }
            ], {
                ...layoutBase,
                title: { text: 'L/R ASYMMETRY % (Threshold Alert)', font: { size: 13, weight: 700 }, x: 0 },
                yaxis: { title: 'Deficit %', range: [-55, 55], zeroline: true, zerolinecolor: '#4d2994', zerolinewidth: 2 },
                shapes: [{ type: 'rect', x0: t[0], x1: t[t.length - 1], y0: -threshold, y1: threshold, fillcolor: 'rgba(34, 197, 94, 0.15)', line: {width: 0} }]
            }, { responsive: true, displayModeBar: false });

            setSignal('done', 100, "Ready");
            document.getElementById('exportBtn').classList.remove('hidden');
        }

        function updateTableUI() {
            const container = document.getElementById('tableContainer');
            let tableHTML = '<table class="w-full text-left border-collapse report-table shadow-sm">';
            const phases = ["General Overview", "Eccentric Phase", "Concentric Phase", "Landing Phase"];
            
            phases.forEach(phase => {
                if(!reportData[phase]) return;
                tableHTML += `<tr><th colspan="3" class="phase-header uppercase font-extrabold text-primary">${phase}</th></tr>`;
                Object.entries(reportData[phase]).forEach(([metric, data]) => {
                    tableHTML += `
                        <tr>
                            <td class="w-1/2 text-primary-dark font-bold">${metric}</td>
                            <td class="w-1/4 text-right text-primary font-extrabold text-xl tracking-tight">${data.val}</td>
                            <td class="w-1/4 text-left text-[11px] uppercase font-bold text-primary-dark opacity-70 pl-4 tracking-widest">${data.unit}</td>
                        </tr>
                    `;
                });
            });
            tableHTML += '</table>';
            container.innerHTML = tableHTML;
        }

        document.getElementById('exportBtn').onclick = () => {
            let csvRows = [
                ["PRIMA MOTION BIOMECHANICS REPORT"],
                ["Device: JUMPANZ V1.7.1 PRO"],
                ["Date:", new Date().toLocaleString()],
                [""],
                ["PHASE", "METRIC", "VALUE", "UNIT"]
            ];
            for (const [phase, metrics] of Object.entries(reportData)) {
                for (const [metricName, data] of Object.entries(metrics)) {
                    csvRows.push([phase, metricName, data.val, data.unit]);
                }
            }
            let csvContent = csvRows.map(row => row.map(cell => `"${cell}"`).join(",")).join("\n");
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement("a");
            link.setAttribute("href", url);
            link.setAttribute("download", `Prima_Motion_JUMPANZ_Report_V1.7.csv`);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        };
    </script>
</body>
</html>
